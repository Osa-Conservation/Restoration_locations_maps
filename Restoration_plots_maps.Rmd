---
title: "Restoration Plots Audit"
author: "Chris Beirne"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=F, warning=F)


library(googledrive)
library(googlesheets4)
library(readxl)
library(sf)
library(leaflet)
library(stringr)


# import the pooled restoration sites file
aoi_all <- st_read("data/processed/restoration_locations.shp")
# Biodiversity data
bio_surveys <- read.csv("data/processed/biodiversity_surveys.csv", header=T)

```

## Restoration plots

The aim of this document is to present Planet Labs with all the locations we have performed restoration. 

The following maps represent the landowners properties where we have performed such activities. **IMPORTANT POINT** these are not the areas planted! 

I used the shapefiles provided by the restoration team in [this folder](https://drive.google.com/drive/folders/1Mc7kTYGHt1Sv0BTXhdB7YWVeqc7TgBEt?usp=drive_link).

```{r}
m <- leaflet() %>%
  # Add a satellite image layer  
  addProviderTiles(providers$CartoDB.PositronNoLabels, group="Simple") %>%
  addProviderTiles(providers$Esri.WorldImagery, group="Satellite") %>%
  addProviderTiles(providers$OpenStreetMap.Mapnik, group="OS")%>%
  addLayersControl(
    baseGroups = c("OS", "Simple", "Satellite"),
    overlayGroups = c(unique(aoi_all$type)),
    options = layersControlOptions(collapsed = FALSE)
  ) %>% 
addLegend(position="bottomleft", labels=c("Farms4Nature", "Planned - '24", "Planted - '23", 
                                        "Planted - '22","Planted - '21","Planted - '20",
                                        "Planted - Enriched"), 
                colors=c("#3EFAEE","#FB991D","#ffcd12","#007e2f","#16317d", "#a40000","#b86092")  
                         , title="Type", opacity=1)
m <-   m %>%   addPolygons(data=aoi_all, label=paste(aoi_all$location, aoi_all$type, aoi_all$year), 
                           color = aoi_all$colour,group=aoi_all$type, opacity=1)

m
```

## Biodiversity surveys

An important element of this was to check the the biodiversity surveys are also occuring in the places where restoration is occur. Below I overlay the survey locations provided by the Wildlife team in [this folder](https://drive.google.com/file/d/1JX46nqOdnDMEoF0yYQx7T2LWeqv4yqIX/view).

It seems like four of the locations I don't have polygons for. Maybe we no longer work with those landowners?

RF29 - Sonia Aragon (near Agua Buena)

RF12 - Tulio Coopesabalito (near Sabalito)

RF19 - Vilma Garcia (near Colorado)

RF20 - Irvin Rodriguez (near La Lucha)

```{r}
m <- leaflet() %>%
  # Add a satellite image layer  
  addProviderTiles(providers$CartoDB.PositronNoLabels, group="Simple") %>%
  addProviderTiles(providers$Esri.WorldImagery, group="Satellite") %>%
  addProviderTiles(providers$OpenStreetMap.Mapnik, group="OS")%>%
  addLayersControl(
    baseGroups = c("OS", "Simple", "Satellite"),
    overlayGroups = c(unique(aoi_all$type), "biodiversity"),
    options = layersControlOptions(collapsed = FALSE)
  ) %>% 
addLegend(position="bottomleft", labels=c("Farms4Nature", "Planned - '24", "Planted - '23", 
                                        "Planted - '22","Planted - '21","Planted - '20",
                                        "Planted - Enriched"), 
                colors=c("#3EFAEE","#FB991D","#ffcd12","#007e2f","#16317d", "#a40000","#b86092")  
                         , title="Type", opacity=1)
m <-   m %>%   addPolygons(data=aoi_all, label=paste(aoi_all$location, aoi_all$type, aoi_all$year), 
                           color = aoi_all$colour,group=aoi_all$type, opacity=1)

m <-   m %>%   addMarkers(lng=bio_surveys$Longitud, lat=bio_surveys$Latitud, label=paste(bio_surveys$site_ID, "-", bio_surveys$farmer),
                                group="biodiversity")
m




```


